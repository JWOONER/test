<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.spring_boot_mybatis.book.dao.IBookDAO">
  	<resultMap id="bookResult" type="com.spring_boot_mybatis.book.model.BookVO" >
  		<result property="bookNo"  column="bookNo"  />
  		<result property="bookName"  column="bookName"  />
  		<result property="bookAuthor"  column="bookAuthor"  />
  		<result property="bookPrice"  column="bookPrice"  />
  		<result property="bookStock"  column="bookStock"  />
  		<result property="bookDate"  column="bookDate"  />

  	</resultMap>
  
  <!-- 전체 상품 조회 -->
  <select id="listAllBook" resultMap="bookResult">
  		SELECT * FROM book ORDER BY bookNo
   </select>
  <insert id="insertBook" parameterType="com.spring_boot_mybatis.book.model.BookVO">
        INSERT INTO book(bookNo,bookName,bookAuthor,bookPrice,bookStock,bookDate)
        VALUES(#{bookNo},#{bookName},#{bookAuthor},#{bookPrice},#{bookStock},#{bookDate})
  </insert>
 <select id="detailViewBook" parameterType="string" resultType="com.spring_boot_mybatis.book.model.BookVO">
        SELECT*FROM book WHERE bookNo=#{bookNo}
 </select>
 <update id="updateBook" parameterType="com.spring_boot_mybatis.book.model.BookVO">
         UPDATE book SET bookName=#{bookName},bookAuthor=#{bookAuthor},bookPrice=#{bookPrice},
         bookStock=#{bookStock},bookDate=#{bookDate}
         WHERE bookNo=#{bookNo}
 </update>
 <delete id="deleteBook" parameterType="string">
         DELETE FROM book WHERE bookNo=#{bookNo}   
 </delete>
 <!--  상품번호 중복 확인-->
  <select id="bookNoCheck" parameterType="string"  resultType="string">
  		SELECT bookNo FROM book WHERE bookNo=#{bookNo}
  </select>
   <!-- 상품 검색  -->
  <select id="bookSearch" parameterType="hashmap" resultMap="bookResult">
  SELECT*FROM book WHERE
  <choose>
  <when test="type!=null and type.equals('bookName')">
  bookName Like CONCAT('%',#{keyword},'%')
  </when>
 <when test="type!=null and type.equals('bookAuthor')">
  bookAuthor Like CONCAT('%',#{keyword},'%')
  </when>
  </choose>
  </select>
  </mapper>
  
  